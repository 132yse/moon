/**
 * Moon v0.11.0
 * Copyright 2016-2017 Kabir Shah
 * Released under the MIT License
 * http://moonjs.ga
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";function e(){this.target=void 0,this.cache={},this.map={}}function t(t){void 0===t&&(t={}),this.options=t,v(this,"name",t.name,"Root"),this.root=void 0;var n=t.data;this.data=void 0===n?{}:"function"==typeof n?n():n;var r=t.methods;this.methods={},void 0!==r&&x(this,r),v(this,"compiledRender",t.render,u),v(this,"hooks",t.hooks,{}),this.events={},this.dom={},this.observer=new e,this.queued=!0;var o=t.computed;void 0!==o&&N(this,o),this.init()}var n={},r={},o={},i=function(e){!1===t.config.silent&&console.log(e)},a=function(e){!1===t.config.silent&&console.error("[Moon] ERROR: "+e)},s=function(e){!1===e.queued&&(e.queued=!0,setTimeout(function(){e.build(),e.queued=!1,d(e,"updated")},0))},d=function(e,t){var n=e.hooks[t];void 0!==n&&n.call(e)},v=function(e,t,n,r){e[t]=void 0===n?r:n},u=function(){},f=function(e,t){for(var n in t)!function(n){var r=function(e){for(var t=r.handlers,n=0;n<t.length;n++)t[n](e)};r.handlers=t[n],t[n]=r,e.addEventListener(n,r)}(n)},c=function(e){var t,n=e.type,r=e.data;if("#text"===n)t=document.createTextNode(e.value);else{var o=e.children;t=1===r.SVG?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n);for(var i=0;i<o.length;i++)l(o[i],t);var a=r.events;void 0!==a&&f(t,a),m(t,void 0,e,e.props)}return r.node=t,t},l=function(e,t){var n=e.data.component;if(void 0===n)t.appendChild(c(e));else{var r=document.createElement(e.type);t.appendChild(r),h(r,e,n)}},p=function(e,t,n,r){if("#text"===e)return{type:e,value:t,data:{}};var i=o[e];return void 0!==i&&(n.component=i),{type:e,props:t,data:n,children:r}};p.flatten=function(e){for(var t=0;t<e.length;){var n=e[t];if(!0===Array.isArray(n)){var r=n.length;n.unshift(t,1),e.splice.apply(e,n),n.slice(2,0),t+=r}else t++}return e},p.renderClass=function(e){if("string"==typeof e)return e;var t="",n="";if(!0===Array.isArray(e))for(var r=0;r<e.length;r++)t+=n+p.renderClass(e[r]),n=" ";else if("object"==typeof e)for(var o in e)!0===e[o]&&(t+=n+o,n=" ");return t},p.renderLoop=function(e,t){var n;if(Array.isArray(e)){var r=e.length;n=new Array(r);for(var o=0;o<r;o++)n[o]=t(e[o],o)}else if("object"==typeof e){n=[];for(var i in e)n.push(t(e[i],i))}else if("number"==typeof e){n=new Array(e);for(var a=0;a<e;a++)n[a]=t(a+1,a)}return n};var h=function(e,t,n){var r=n.options.props,o=t.props.attrs,i={};if(void 0!==r&&void 0!==o)for(var a=0;a<r.length;a++){var s=r[a];i[s]=o[s]}var d={root:e,props:i,insert:t.children},v=t.data.events;d.events=void 0===v?{}:v;var u=new n.CTor(d),f=t.data;f.component=u,f.node=u.root},m=function(e,t,r,o){var i=o.attrs;if(void 0===i){if(void 0!==t)for(var a in t)e.removeAttribute(a)}else if(void 0===t)for(var s in i){var d=i[s];e.setAttribute(s,!0===d?"":d)}else{for(var v in i){var u=i[v],f=t[v];!1===u||void 0!==f&&u===f||e.setAttribute(v,!0===u?"":u)}for(var c in t){var l=i[c];void 0!==l&&!1!==l||e.removeAttribute(c)}}var p=o.directives;if(void 0!==p)for(var h in p){var m=n[h];void 0!==m&&m(e,p[h],r)}var g=o.dom;if(void 0!==g)for(var y in g)e[y]=g[y]},g=function(e,t){for(var n in e)t[n].handlers=e[n]},y=function(e,t){var n=t.data;n.node=e;for(var r=t.props,o=e.attributes,i={},a=0;a<o.length;a++){var s=o[a];i[s.name]=s.value}m(e,i,t,r);var d=n.events;void 0!==d&&f(e,d);var v=r.dom;if(void 0===v||void 0===v.innerHTML&&void 0===v.textContent)for(var u=t.children,p=u.length,g=0,b=g===p?void 0:u[g],x=e.firstChild;void 0!==b||null!==x;){if(null===x)l(b,e);else{var N=x.nextSibling;if(void 0===b)e.removeChild(x);else{var w=b.data.component;if(void 0!==w)h(x,b,w);else{var C=b.type;x.nodeName.toLowerCase()!==C?e.replaceChild(c(b),x):"#text"===C?(x.textContent=b.value,b.data.node=x):y(x,b)}}x=N}b=++g<p?u[g]:void 0}},b=function(e,t){var n=t.data,r=n.node,o=e.props;m(r,t.props.attrs,e,o),t.props=o;var i=e.data.events;void 0!==i&&g(i,n.events);for(var a=e.children,s=t.children,v=a.length,u=s.length,f=v>u?v:u,p=0;p<f;p++)if(p>=v){var y=s.pop().data,x=y.component;void 0!==x&&x.destroy(),r.removeChild(y.node)}else if(p>=u)l(s[p]=a[p],r);else{var N=a[p],w=s[p],C=N.type;if(C!==w.type){var O=w.data,A=O.component;void 0!==A&&A.destroy();var T=N.data.component;void 0===T?r.replaceChild(c(N),O.node):h(O.node,N,T),s[p]=N}else if(N!==w){var k=w.data,R=k.component;if(void 0!==R){var q=!1,j=R.options.props;if(void 0!==j){for(var E=N.props.attrs,L=R.observer,S=R.data,z=0;z<j.length;z++){var M=j[z];S[M]=E[M],L.notify(M)}q=!0}var V=N.data.events;void 0!==V&&g(V,k.events);var Z=N.children;0!==Z.length&&(R.insert=Z,q=!0),!0===q&&(R.build(),d(R,"updated"))}else if("#text"===C){var $=N.value;k.node.textContent=$,w.value=$}else b(N,w)}}},x=function(e,t){var n=e.methods;for(var r in t)!function(r){n[r]=function(){return t[r].apply(e,arguments)}}(r)},N=function(e,t){var n=e.data,r=e.observer;for(var o in t)!function(o){var i=t[o],a=i.get,s=i.set;Object.defineProperty(n,o,{get:function(){var t;return void 0===r.cache[o]?(r.target=o,t=a.call(e),r.target=void 0,r.cache[o]=t):t=r.cache[o],t},set:void 0===s?u:function(t){s.call(e,t)}})}(o)};e.prototype.notify=function(e){var t=this,n=this.map[e];if(void 0!==n)for(var r=0;r<n.length;r++)t.notify(n[r]);var o=this.cache;void 0!==o[e]&&(o[e]=void 0)};var w=/\{\{\s*/,C=/\s*\}\}/,O=/[\s\n]/,A=/[\s\n]/g,T=/<\/?(?:[A-Za-z]+\w*)|<!--/,k=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)(?:\s*\()?/g,R=/(?:(?:&(?:lt|gt|quot|amp);)|"|\\|\n)/g,q={"&lt;":"<","&gt;":">","&quot;":'\\"',"&amp;":"&","\\":"\\\\",'"':'\\"',"\n":"\\n"},j=["instance","staticNodes","true","false","undefined","null","NaN","typeof","in"],E=["area","base","br","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],L=["animate","circle","clippath","cursor","defs","desc","ellipse","filter","font-face","foreignObject","g","glyph","image","line","marker","mask","missing-glyph","path","pattern","polygon","polyline","rect","svg","switch","symbol","text","textpath","tspan","use","view"],S=function(e,t){for(var n,r=t.dependencies,o=r.props,i=r.methods,a=t.exclude,s=t.locals,d=!1;null!==(n=k.exec(e));){var v=n[0],u=n[1];void 0!==u&&-1===a.indexOf(u)&&("("===v[v.length-1]?-1===i.indexOf(u)&&i.push(u):(-1===s.indexOf(u)&&-1===o.indexOf(u)&&o.push(u),d=!0))}return d},z=function(e,t){var n=e.length,r=0,o=!1,i="";if(0===n)i='""';else for(;r<n;){var a=e.substring(r),s=a.match(w);if(null===s){i+='"'+a+'"';break}var d=s.index;0!==d&&(i+='"'+a.substring(0,d)+'"',r+=d),o=!0,0!==r&&(i+=" + "),r+=s[0].length;var v=e.substring(r),u=v.match(C),f=u.index,c=v.substring(0,f);S(c,t),i+="("+c+")",(r+=c.length+u[0].length)!==n&&(i+=" + ")}return{output:i,dynamic:o}},M=function(e){for(var t=e.length,n=[],r=0;r<t;){var o=e[r];if("<"===o)if(r++,"!--"===e.substring(r,r+3)){r+=3;var i=e.indexOf("--\x3e",r);r=-1===i?t:i+3}else{var a={type:"Tag",value:""},s="",d={},v=!1,u=!1;for("/"===(o=e[r])&&(o=e[++r],v=!0);r<t&&">"!==o&&"/"!==o&&!1===O.test(o);)s+=o,o=e[++r];for(;r<t&&">"!==o&&("/"!==o||">"!==e[r+1]);)if(!0===O.test(o))o=e[++r];else{for(var f="",c="";r<t&&"="!==o&&!1===O.test(o)&&">"!==o&&("/"!==o||">"!==e[r+1]);)f+=o,o=e[++r];if("="===o){var l=" ";for('"'!==(o=e[++r])&&"'"!==o&&" "!==o&&"\n"!==o||(l=o,o=e[++r]);r<t&&">"!==o&&("/"!==o||">"!==e[r+1]);){if(o===l){o=e[++r];break}c+=o,o=e[++r]}}var p={name:f,value:c,argument:void 0,data:{}},h=f.split(":");2===h.length&&(p.name=h[0],p.argument=h[1]),d[f]=p}"/"===o?(r+=2,u=!0):r++,a.value=s,a.attributes=d,a.closeStart=v,a.closeEnd=u,n.push(a)}else{var m=e.substring(r),g=m.search(T),y=void 0;-1===g?(y=m,r=t):(y=m.substring(0,g),r+=g),0!==y.replace(A,"").length&&n.push({type:"Text",value:y.replace(R,function(e){return q[e]})})}}return n},V=function(e){for(var t={type:"ROOT",props:{},children:[]},n=[t],r=0,o=0;o<e.length;o++){var i=e[o];if("Text"===i.type)n[r].children.push({type:"#text",value:i.value});else if("Tag"===i.type)if(!0===i.closeStart)n.pop(),r--;else{var a=i.value,s=n[r].children,d=s.length,v={type:a,index:d,props:{attrs:i.attributes},children:[]};s[d]=v,!1===i.closeEnd&&-1===E.indexOf(a)&&(n.push(v),r++)}}return t.children[0]},Z=function(e,t){var n=t.length;return t[n]=e,"staticNodes["+n+"]"},$=function(e,t,n){var o=e.type;if("#text"===o){var i=z(e.value,n);return{output:'m("#text", '+i.output+")",dynamic:i.dynamic}}if("m-insert"===o)return t.deep=!0,{output:"instance.insert",dynamic:!0};var a='m("'+o+'", {',s=!1,d="",v=e.data={};-1!==L.indexOf(o)&&(v.SVG=1);var u,f,c,l,p,h=e.props,m=h.attrs,g=[],y=[],b=[];for(f in m)c=m[f],void 0!==(u=r[c.name])&&void 0!==(p=u.before)&&!0===p(c,e,t,n)&&(s=!0);for(f in m)if(c=m[f],void 0!==(u=r[c.name])){var x=u.after;void 0!==x&&b.push({attr:c,after:x});var N=u.during;if(void 0!==N){var w=N(c,e,t,n);void 0!==w&&(!0===w.dynamic&&(s=!0),g.push(w.output))}}else"m"===f[0]&&"-"===f[1]?y.push(c):g.push(c);var C=g.length,O=!1;if(0!==C){for(a+="attrs: {",l=0;l<C;l++){if("string"==typeof(c=g[l]))a+=d+c;else{var A=z(c.value,n);!0===A.dynamic&&(s=!0),a+=d+'"'+c.name+'": '+A.output}d=", "}d="",a+="}",O=!0}var T=y.length;if(0!==T){for(!0===O?a+=", directives: {":(a+="directives: {",O=!0),l=0;l<T;l++){var k=(c=y[l]).value;0===k.length?k='""':!0===S(k,n)&&(s=!0),a+=d+'"'+c.name+'": '+k,d=", "}d="",a+="}"}var R=h.dom;if(void 0!==R){a+=!0===O?", dom: {":"dom: {";for(var q in R){var j=R[q];!0===S(j,n)&&(s=!0),a+=d+'"'+q+'": '+j,d=", "}d="",a+="}"}a+="}, {";var E=v.events,M="";if(void 0!==E){a+="events: {";for(var V in E){a+=d+'"'+V+'": [';var _=E[V];for(l=0;l<_.length;l++)a+=M+_[l],M=", ";d=", ",M="",a+="]"}a+="}",delete v.events}for(var I in v)a+=""+d+I+": "+v[I],d=", ";a+="}, ";var G=e.children,H=[],F="";for(d="",l=0;l<G.length;l++){var P=$(G[l],e,n);!0===P.dynamic&&(s=!0),H.push(P)}var B=n.staticNodes;for(l=0;l<H.length;l++){var D=H[l];!0===s&&!1===D.dynamic?F+=d+Z(D.output,B):F+=d+D.output,d=", "}for(!0===e.deep?a+="m.flatten(["+F+"]))":a+="["+F+"])",l=0;l<b.length;l++){var J=b[l];a=J.after(J.attr,a,e,t,n)}return{output:a,dynamic:s}},_=function(e){var t={staticNodes:[],dependencies:{props:[],methods:[]},exclude:j,locals:[]},n=$(e,void 0,t),r=t.dependencies,o=r.props,i=r.methods,s="",d=t.staticNodes,v="",f=0,c="";for(!0===n.dynamic?n=n.output:(d[0]=n.output,n="staticNodes[0]");f<o.length;f++){var l=o[f];s+="var "+l+' = instance.get("'+l+'");'}for(f=0;f<i.length;f++){var p=i[f];s+="var "+p+' = instance.methods["'+p+'"];'}for(f=0;f<d.length;f++)v+=c+d[f],c=", ";try{return new Function("m","var instance = this;var staticNodes = instance.compiledRender.staticNodes;"+s+"if(staticNodes === undefined) {staticNodes = instance.compiledRender.staticNodes = ["+v+"];}return "+n+";")}catch(e){return a("Could not create render function"),u}},I=function(e){return _(V(M(e)))};t.prototype.get=function(e){var t=this.observer,n=t.map,r=t.target;return void 0!==r&&(void 0===n[e]?n[e]=[r]:-1===n[e].indexOf(r)&&n[e].push(r)),this.data[e]},t.prototype.set=function(e,t){var n=this.observer;if("object"==typeof e){var r=this.data;for(var o in e)r[o]=e[o],n.notify(o)}else this.data[e]=t,n.notify(e);s(this)},t.prototype.destroy=function(){this.off(),this.root=void 0,this.queued=!0,d(this,"destroyed")},t.prototype.on=function(e,t){var n=this.events,r=n[e];void 0===r?n[e]=[t]:r.push(t)},t.prototype.off=function(e,t){if(void 0===e)this.events={};else if(void 0===t)this.events[e]=[];else{var n=this.events[e],r=n.indexOf(t);n.splice(r,1)}},t.prototype.emit=function(e,t){var n,r=this.events,o=r[e],i=r["*"];if(void 0!==o)for(n=0;n<o.length;n++)o[n](t);if(void 0!==i)for(n=0;n<i.length;n++)i[n](e,t)},t.prototype.mount=function(e){var n=this.root="string"==typeof e?document.querySelector(e):e;v(this,"template",this.options.template,n.outerHTML),this.compiledRender===u&&(this.compiledRender=t.compile(this.template)),this.queued=!1;var r=this.render();if(n.nodeName.toLowerCase()===r.type)y(n,r);else{var o=c(r);n.parentNode.replaceChild(o,n),this.root=o}this.dom=r,d(this,"mounted")},t.prototype.render=function(){return this.compiledRender(p)},t.prototype.build=function(){var e=this.render(),t=this.dom;e!==t&&b(e,t)},t.prototype.init=function(){i("======= Moon ======="),d(this,"init");var e=this.options.root;void 0!==e&&this.mount(e)},t.config={silent:!0},t.version="0.11.0",t.util={noop:u,log:i,error:a,m:p},t.use=function(e,n){e.init(t,n)},t.compile=function(e){return I(e)},t.nextTick=function(e){setTimeout(e,0)},t.directive=function(e,t){n["m-"+e]=t},t.extend=function(e,n){function r(e){this.componentOptions=e,t.apply(this,[n])}return n.name=e,void 0!==n.data&&"function"!=typeof n.data&&a("In components, data must be a function returning an object"),r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.init=function(){var e=this.componentOptions,t=e.props,n=this.data;for(var r in t)n[r]=t[r];this.events=e.events,this.insert=e.insert,d(this,"init");var o=e.root;void 0!==o&&this.mount(o)},o[e]={CTor:r,options:n},r};var G=/\.|\[/,H=function(e,t,n){var r=n.data,o=r.events;if(void 0===o)(o=r.events={})[e]=[t];else{var i=o[e];void 0===i?o[e]=[t]:i.push(t)}},F=function(e,t,n){var r=n.props.dom;void 0===r&&(n.props.dom=r={}),r[e]=t};return r["m-if"]={before:function(e,t,n,r){var o=n.children,i=t.index+1,a=o[i],s=S(e.value,r),d=e.data;if(void 0!==a){var v=a.props.attrs;void 0!==v["m-else"]&&(delete v["m-else"],d.elseNode=$(a,n,r),o.splice(i,1))}if(!0===s){var u=t.props.attrs,f=u["m-if"];delete u["m-if"],d.ifNode=$(t,n,r),t.children=[],u["m-if"]=f}return s},after:function(e,t,n,r,o){var i,a=e.data,s=a.ifNode,d=a.elseNode,v=t,u=o.staticNodes;return void 0!==s&&(v=!0===s.dynamic?s.output:Z(s.output,u)),i=void 0===d?Z("m(\"#text\", '')",u):!0===d.dynamic?d.output:Z(d.output,u),e.value+" ? "+v+" : "+i}},r["m-for"]={before:function(e,t,n,r){n.deep=!0;var o=e.value.split(" in "),i=o[0],a=o[1],s=r.locals;return e.data.forInfo=[a,i,s],r.locals=s.concat(i.split(",")),S(a,r)},after:function(e,t,n,r,o){var i=e.data.forInfo;return o.locals=i[2],"m.renderLoop("+i[0]+", function("+i[1]+") {return "+t+";})"}},r["m-on"]={before:function(e,t,n,r){var o=r.exclude,i=e.value;-1===i.indexOf("(")&&(i+="()"),H(e.argument,"function(event) {"+i+";}",t),o.push("event");var a=S(i,r);return o.pop(),a}},r["m-bind"]={before:function(e,t,n,r){var o,i,a=e.value,s=a.search(G);-1!==s&&(a='instance.get("'+(o=a.substring(0,s))+'")'+(i=a.substring(s)));var d=a,v=a,u="";return u=-1===s?'function(event) {instance.set("'+d+'", event.target.value);}':'function(event) {var boundValue = instance.get("'+o+'");boundValue'+i+' = event.target.value;instance.set("'+o+'", boundValue);}',H("input",u,t),F("value",v,t),S(a,r)}},r["m-literal"]={during:function(e,t,n,r){var o=e.argument.split("."),i=o.shift(),a=e.value,s=void 0;return"dom"===o[0]?(F(i,a,t),s):(s="class"===i?'"class": m.renderClass('+a+")":'"'+i+'": '+a,{output:s,dynamic:S(a,r)})}},r["m-mask"]={},t});