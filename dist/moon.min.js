/**
 * Moon v1.0.0-alpha
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var c=function(e,t,n){for(;e<n;){var r=t[e],i=t[e+1],u=t[e+2];if("<"===r&&"!"===i&&"-"===u&&"-"===t[e+3])e=c(e+4,t,n);else{if("-"===r&&"-"===i&&">"===u){e+=3;break}e+=1}}return e},a=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,m=function(e,t,n){for(var r,i=!1;null!==(r=a.exec(e));){var u=r[1];void 0!==u&&-1===n.indexOf(u)&&(t.push(u),i=!0)}return i},e={silent:!0},s=function(e,t){t[t.length-1].children.push(e)},p=/\s/,d=function(e,t,n,r,i,u){for(;e<n;){var a=t[e];if("/"===a||">"===a)break;if(p.test(a))e+=1;else{for(var o="",c="",f="",s=!1;e<n;){if("/"===(a=t[e])||">"===a||p.test(a)){f=o;break}if("="===a){e+=1;break}":"===a&&"m"===o[0]&&"-"===o[1]?(c+=t[e+1],e+=2):(0!==c.length?c+=a:o+=a,e+=1)}if(0===f.length){var d=void 0;for('"'===(a=t[e])||"'"===a?(d=a,e+=1):"{"===a?(d="}",s=!0,e+=1):d=p;e<n&&"/"!==(a=t[e])&&">"!==a;){if("object"==typeof d&&d.test(a)||a===d){e+=1;break}f+=a,e+=1}}r.push({key:o,value:f,argument:c,expression:s,dynamic:s&&m(f,i,u)})}}return e},f=function(e,t,n,r,i,u){for(var a="",o=[];e<n;){var c=t[e];if(">"===c){var f={index:r.parseIndex++,type:a,attributes:o,children:[]};s(f,r),r.push(f),e+=1;break}if("/"===c&&">"===t[e+1]){s({index:r.parseIndex++,type:a,attributes:o,children:[]},r),e+=2;break}p.test(c)?e=d(e+1,t,n,o=[],i,u):(a+=c,e+=1)}return e},v=function(e,t,n,r){for(;e<n;e++){var i=t[e];if(">"===i){e+=1;break}i}var u=r.pop();return u.type,e},o=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,h={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},l=function(e,t,n,r){for(var i="";e<n;e++){var u=t[e];if("<"===u||"{"===u)break;i+=u}return s({index:r.parseIndex++,type:"m-text",content:i.replace(o,function(e){return h[e]})},r),e},x=function(e,t,n,r,i,u){for(var a="";e<n;e++){var o=t[e];if("}"===o){e+=1;break}a+=o}return s({index:r.parseIndex++,type:"m-expression",content:a,dynamic:m(a,i,u)},r),e},i=function(e,n){return e.reduce(function(e,t){return e+n(t)},"")},r=function(e){return e.expression?e.value:'"'+e.value+'"'},u=function(e){switch(e.type){case"m-fragment":return i(e.children,u);case"m-expression":return"m["+e.index+"]=m.ct("+e.content+");";case"m-text":return"m["+e.index+']=m.ct("'+e.content+'");';default:return i(e.children,u)+"m["+e.index+']=m.ce("'+e.type+'");'+i((n=e).attributes,function(e){var t=e.key;switch(t){case"m-for":case"m-if":break;case"m-on":return"m["+n.index+'].addEventListener("'+e.argument+'", function(event){'+r(e)+"});";default:return"m["+n.index+'].setAttribute("'+t+'",'+r(e)+");"}})}var n},y=function(e,t){var n="";switch(e.type){case"m-fragment":return i(e.children,function(e){return y(e,t)});default:var r="m["+e.index+"]";"m-text"!==e.type&&"m-expression"!==e.type&&(n+=i(e.children,function(e){return y(e,r)})),n+="m.ma("+r+","+t+");"}return n},b=function(e){switch(e.type){case"m-expression":return e.dynamic?"m.ut(m["+e.index+"],"+e.content+");":"";case"m-text":return"";default:return i((n=e).attributes,function(e){if(!e.dynamic)return"";var t=e.key;switch(t){case"m-for":case"m-if":break;case"m-on":return"";default:return"m["+n.index+'].setAttribute("'+t+'",'+e.value+");"}})+i(e.children,b)}var n},g=function(e){return t=function(e){for(var t=e.length,n=[],r=["NaN","event","false","in","null","this","true","typeof","undefined"],i={type:"m-fragment",attributes:[],children:[],dependencies:n},u=[i],a=u.parseIndex=0;a<t;){var o=e[a];a="<"===o?"!"===e[a+1]&&"-"===e[a+2]&&"-"===e[a+3]?c(a+4,e,t):"/"===e[a+1]?v(a+2,e,t,u):f(a+1,e,t,u,n,r):"{"===o?x(a+1,e,t,u,n,r):l(a,e,t,u)}return i}(e),n="var m=this.m;"+i(t.dependencies,function(e){return"var "+e+"=this.data."+e+";"}),new Function("return [function(){"+n+u(t)+"},function(root){var m=this.m;"+y(t,"root")+"},function(){"+n+b(t)+"}]")();var t,n},k={},w=function(e){return document.createElement(e)},q=function(e){return document.createTextNode(e)},A=function(e,t){t.appendChild(e)},I=function(e,t){e.textContent=t},z=function(e,t){if("object"==typeof e)for(var n in e)this.set(n,e[n]);else if(this.data[e]=t,!1===this.queued){this.queued=!0;var r=this;setTimeout(function(){r.update(),r.queued=!1},0)}},Z=function(r,i,u){return function(){var e;this.name=r,this.data=u(),this.queued=!1,this.create=i[0],this.mount=i[1],this.update=i[2],this.set=z,this.m=((e=[]).c=k,e.ce=w,e.ct=q,e.ma=A,e.ut=I,e);var t=this.data.actions;for(var n in t)t[n]=t[n].bind(this)}};function t(e,t,n){if("string"==typeof e&&(e=document.querySelector(e)),"string"==typeof t&&(t=g(t)),void 0===n)n=function(){return{}};else if("object"==typeof n){var r=n;n=function(){return r}}var i=new(Z("m-root",t,n));return i.create(),i.mount(e),i}return t.extend=function(e,t,n){"string"==typeof t&&(t=g(t)),void 0===n&&(n=function(){return{}}),k[e]=Z(e,t,n)},t.compile=g,t.config=e,t});