/**
 * Moon v1.0.0-alpha
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var c=function(e,t,n){for(;e<n;){var r=t[e],i=t[e+1],u=t[e+2];if("<"===r&&"!"===i&&"-"===u&&"-"===t[e+3])e=c(e+4,t,n);else{if("-"===r&&"-"===i&&">"===u){e+=3;break}e+=1}}return e},o=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,d=function(e,t,n){for(var r,i=!1;null!==(r=o.exec(e));){var u=r[1];void 0!==u&&-1===n.indexOf(u)&&(t.push(u),i=!0)}return i},e={silent:!0},s=function(e,t){t[t.length-1].children.push(e)},m=/\s/,p=function(e,t,n,r,i,u){for(;e<n;){var o=t[e];if("/"===o||">"===o)break;if(m.test(o))e+=1;else{for(var a="",c="",f=!1;e<n;){if("/"===(o=t[e])||">"===o||m.test(o)){c=a;break}if("="===o){e+=1;break}a+=o,e+=1}if(0===c.length){var s=void 0;for('"'===(o=t[e])||"'"===o?(s=o,e+=1):"{"===o?(s="}",f=!0,e+=1):s=m;e<n&&"/"!==(o=t[e])&&">"!==o;){if("object"==typeof s&&s.test(o)||o===s){e+=1;break}c+=o,e+=1}}r.push({key:a,value:c,expression:f,dynamic:f&&d(c,i,u)})}}return e},f=function(e,t,n,r,i,u){for(var o="",a=[];e<n;){var c=t[e];if(">"===c){var f={index:r.parseIndex++,type:o,attributes:a,children:[]};s(f,r),r.push(f),e+=1;break}if("/"===c&&">"===t[e+1]){s({index:r.parseIndex++,type:o,attributes:a,children:[]},r),e+=2;break}m.test(c)?e=p(e+1,t,n,a=[],i,u):(o+=c,e+=1)}return e},l=function(e,t,n,r){for(;e<n;e++){var i=t[e];if(">"===i){e+=1;break}i}var u=r.pop();return u.type,e},a=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,v={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},x=function(e,t,n,r){for(var i="";e<n;e++){var u=t[e];if("<"===u||"{"===u)break;i+=u}return s({index:r.parseIndex++,type:"m-text",content:i.replace(a,function(e){return v[e]})},r),e},h=function(e,t,n,r,i,u){for(var o="";e<n;e++){var a=t[e];if("}"===a){e+=1;break}o+=a}return s({index:r.parseIndex++,type:"m-expression",content:o,dynamic:d(o,i,u)},r),e},i=function(e,n){return e.reduce(function(e,t){return e+n(t)},"")},r=function(e){switch(e.type){case"m-fragment":return i(e.children,r);case"m-expression":return"m["+e.index+"] = m.ct("+e.content+");";case"m-text":return"m["+e.index+'] = m.ct("'+e.content+'");';default:var t="m["+e.index+"]";return""+i(e.children,r)+t+' = m.ce("'+e.type+'");'+i(e.attributes,function(e){return t+'.setAttribute("'+e.key+'", '+(e.expression?e.value:'"'+e.value+'"')+");"})}},u=function(e,t){var n="";switch(e.type){case"m-fragment":return i(e.children,function(e){return u(e,t)});default:var r="m["+e.index+"]";"m-text"!==e.type&&"m-expression"!==e.type&&(n+=i(e.children,function(e){return u(e,r)})),n+="m.ma("+r+", "+t+");"}return n},y=function(e){switch(e.type){case"m-expression":return e.dynamic?"m.ut(m["+e.index+"], "+e.content+");":"";case"m-text":return"";default:var t="m["+e.index+"]";return i(e.attributes,function(e){return e.dynamic?t+'.setAttribute("'+e.key+'", '+e.value+");":""})+i(e.children,y)}},b=function(e){return t=function(e){for(var t=e.length,n=[],r=["NaN","false","in","null","true","typeof","undefined"],i={type:"m-fragment",attributes:[],children:[],dependencies:n},u=[i],o=u.parseIndex=0;o<t;){var a=e[o];o="<"===a?"!"===e[o+1]&&"-"===e[o+2]&&"-"===e[o+3]?c(o+4,e,t):"/"===e[o+1]?l(o+2,e,t,u):f(o+1,e,t,u,n,r):"{"===a?h(o+1,e,t,u,n,r):x(o,e,t,u)}return i}(e),n="var m = this.m;"+i(t.dependencies,function(e){return"var "+e+" = this.data."+e+";"}),new Function("return [function(){"+n+r(t)+"},function(root){var m = this.m;"+u(t,"root")+"},function(){"+n+y(t)+"}]")();var t,n},g={},k=function(e){return document.createElement(e)},w=function(e){return document.createTextNode(e)},A=function(e,t){t.appendChild(e)},I=function(e,t){e.textContent=t},z=function(t,n,r){return function(){var e;this.name=t,this.data=r(),this.create=n[0],this.mount=n[1],this.update=n[2],this.m=((e=[]).c=g,e.ce=k,e.ct=w,e.ma=A,e.ut=I,e)}};function t(e,t,n){if("string"==typeof e&&(e=document.querySelector(e)),"string"==typeof t&&(t=b(t)),void 0===n)n=function(){return{}};else if("object"==typeof n){var r=n;n=function(){return r}}var i=new(z("m-root",t,n));return i.create(),i.mount(e),i}return t.extend=function(e,t,n){"string"==typeof t&&(t=b(t)),void 0===n&&(n=function(){return{}}),g[e]=z(e,t,n)},t.compile=b,t.config=e,t});