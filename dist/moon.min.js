/**
 * Moon v1.0.0-alpha
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(t,e){"undefined"==typeof module?t.Moon=e():module.exports=e()}(this,function(){"use strict";var c=function(t,e,n){for(;t<n;){var r=e[t],i=e[t+1],a=e[t+2];if("<"===r&&"!"===i&&"-"===a&&"-"===e[t+3])t=c(t+4,e,n);else{if("-"===r&&"-"===i&&">"===a){t+=3;break}t+=1}}return t},u=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,v=function(t,e,n){for(var r,i=!1;null!==(r=u.exec(t));){var a=r[1];void 0!==a&&-1===n.indexOf(a)&&(e.push(a),i=!0)}return i},t={silent:!0},s=function(t,e){e[e.length-1].children.push(t)},m=/\s/,d=function(t,e,n,r,i,a){for(;t<n;){var u=e[t];if("/"===u||">"===u)break;if(m.test(u))t+=1;else{for(var o="",c="",f="",s=!1;t<n;){if("/"===(u=e[t])||">"===u||m.test(u)){f=o;break}if("="===u){t+=1;break}":"===u&&"m"===o[0]&&"-"===o[1]?(c+=e[t+1],t+=2):(0!==c.length?c+=u:o+=u,t+=1)}if(0===f.length){var d=void 0;for('"'===(u=e[t])||"'"===u?(d=u,t+=1):"{"===u?(d="}",s=!0,t+=1):d=m;t<n&&"/"!==(u=e[t])&&">"!==u;){if("object"==typeof d&&d.test(u)||u===d){t+=1;break}f+=u,t+=1}}r.push({key:o,value:f,argument:c,expression:s,dynamic:s&&v(f,i,a)})}}return t},f=function(t,e,n,r,i,a){for(var u="",o=[];t<n;){var c=e[t];if(">"===c){var f={index:r.parseIndex++,type:u,attributes:o,children:[]};s(f,r),r.push(f),t+=1;break}if("/"===c&&">"===e[t+1]){s({index:r.parseIndex++,type:u,attributes:o,children:[]},r),t+=2;break}m.test(c)?t=d(t+1,e,n,o=[],i,a):(u+=c,t+=1)}return t},h=function(t,e,n,r){for(;t<n;t++){var i=e[t];if(">"===i){t+=1;break}i}var a=r.pop();return a.type,t},o=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,p={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},l=function(t,e,n,r){for(var i="";t<n;t++){var a=e[t];if("<"===a||"{"===a)break;i+=a}return s({index:r.parseIndex++,type:"m-text",content:i.replace(o,function(t){return p[t]})},r),t},x=function(t,e,n,r,i,a){for(var u="";t<n;t++){var o=e[t];if("}"===o){t+=1;break}u+=o}return s({index:r.parseIndex++,type:"m-expression",content:u,dynamic:v(u,i,a)},r),t},i=function(t,n){return t.reduce(function(t,e){return t+n(e)},"")},r=function(t){return t.expression?t.value:'"'+t.value+'"'},a=function(t){switch(t.type){case"m-fragment":return i(t.children,a);case"m-expression":return"m["+t.index+"]=m.ct("+t.content+");";case"m-text":return"m["+t.index+']=m.ct("'+t.content+'");';default:return i(t.children,a)+"m["+t.index+']=m.ce("'+t.type+'");'+i((n=t).attributes,function(t){var e=t.key;switch(e){case"m-for":case"m-if":break;case"m-on":return"m["+n.index+'].addEventListener("'+t.argument+'", function(event){'+r(t)+"});";default:return"m["+n.index+'].setAttribute("'+e+'",'+r(t)+");"}})}var n},b=function(t,e){var n="";switch(t.type){case"m-fragment":return i(t.children,function(t){return b(t,e)});default:var r="m["+t.index+"]";"m-text"!==t.type&&"m-expression"!==t.type&&(n+=i(t.children,function(t){return b(t,r)})),n+="m.ma("+r+","+e+");"}return n},y=function(t){switch(t.type){case"m-expression":return t.dynamic?"m.ut(m["+t.index+"],"+t.content+");":"";case"m-text":return"";default:return i((n=t).attributes,function(t){if(!t.dynamic)return"";var e=t.key;switch(e){case"m-for":case"m-if":break;case"m-on":return"";default:return"m["+n.index+'].setAttribute("'+e+'",'+t.value+");"}})+i(t.children,y)}var n},w=function(t){return e=function(t){for(var e=t.length,n=[],r=["NaN","event","false","in","null","this","true","typeof","undefined"],i={type:"m-fragment",attributes:[],children:[],dependencies:n},a=[i],u=a.parseIndex=0;u<e;){var o=t[u];u="<"===o?"!"===t[u+1]&&"-"===t[u+2]&&"-"===t[u+3]?c(u+4,t,e):"/"===t[u+1]?h(u+2,t,e,a):f(u+1,t,e,a,n,r):"{"===o?x(u+1,t,e,a,n,r):l(u,t,e,a)}return i}(t),n="var m=this.m;"+i(e.dependencies,function(t){return"var "+t+"=this.data."+t+";"}),new Function("return [function(){"+n+a(e)+"},function(root){var m=this.m;"+b(e,"root")+"},function(){"+n+y(e)+"}]")();var e,n},g={},k=function(t){return document.createElement(t)},q=function(t){return document.createTextNode(t)},A=function(t,e){e.appendChild(t)},I=function(t,e){t.textContent=e},z=function(){if(!1===this.queued){this.queued=!0;var t=this;setTimeout(function(){t.view[2](),t.queued=!1},0)}},Z=function(t,e){if("object"==typeof t)for(var n in t)this.set(n,t[n]);else this.data[t]=e,this.build()},$=function(t,e){var n=this.data,r=n[t];void 0===r?n[t]=[e]:r.push(e)},_=function(t,e){if(void 0===e)this.data[t]=[];else{var n=this.data[t];n.splice(n.indexOf(e),1)}},j=function(t,e){for(var n=this.data[t],r=0;r<n.length;r++)n[r](e)},N=function(a,u){return function(){var t,e=this;this.name=a,this.view=u.view.map(function(t){return t.bind(e)}),this.m=((t=[]).c=g,t.ce=k,t.ct=q,t.ma=A,t.ut=I,t);var n=this.data=u.data(),r=u.actions;for(var i in r)n[i]=r[i].bind(e);this.queued=!1,this.build=z,this.set=Z,this.on=$,this.off=_,this.emit=j}};function e(t){var e=t.root;"string"==typeof e&&(e=document.querySelector(e));var n=t.view;"string"==typeof n&&(t.view=w(n));var r=t.data;void 0===r?t.data=function(){return{}}:"object"==typeof r&&(t.data=function(){return r}),void 0===t.actions&&(t.actions={});var i=new(N("m-root",t));return i.view[0](),i.view[1](e),i}return e.extend=function(t,e){var n=e.view;"string"==typeof n&&(e.view=w(n)),void 0===e.data&&(e.data=function(){return{}}),void 0===e.actions&&(e.actions={}),g[t]=N(t,e)},e.compile=w,e.config=t,e});