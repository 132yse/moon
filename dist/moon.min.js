/**
 * Moon v1.0.0-alpha
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var a=function(e,t,n){for(;e<n;){var r=t[e],i=t[e+1],u=t[e+2];if("<"===r&&"!"===i&&"-"===u&&"-"===t[e+3])e=a(e+4,t,n);else{if("-"===r&&"-"===i&&">"===u){e+=3;break}e+=1}}return e},e={silent:!0},s=function(e,t){t[t.length-1].children.push(e)},f=/\s/,d=function(e,t,n,r){for(;e<n;){var i=t[e];if("/"===i||">"===i)break;if(f.test(i))e+=1;else{for(var u="",o="",c=!1;e<n;){if("/"===(i=t[e])||">"===i||f.test(i)){o=u;break}if("="===i){e+=1;break}u+=i,e+=1}if(0===o.length){var a=void 0;for('"'===(i=t[e])||"'"===i?(a=i,e+=1):"{"===i?(a="}",c=!0,e+=1):a=f;e<n&&"/"!==(i=t[e])&&">"!==i;){if("object"==typeof a&&a.test(i)||i===a){e+=1;break}o+=i,e+=1}}r.push({key:u,value:o,literal:c})}}return e},m=function(e,t,n,r){for(var i,u="";e<n;){var o=t[e];if(">"===o){var c={index:r.parseIndex++,type:u,attributes:i,children:[]};s(c,r),r.push(c),e+=1;break}if("/"===o&&">"===t[e+1]){s({index:r.parseIndex++,type:u,attributes:i,children:[]},r),e+=2;break}f.test(o)?e=d(e+1,t,n,i=[]):(u+=o,e+=1)}return e},p=function(e,t,n,r){for(;e<n;e++){var i=t[e];if(">"===i){e+=1;break}i}var u=r.pop();return u.type,e},o=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,c={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},l=function(e,t,n,r){for(var i="";e<n;e++){var u=t[e];if("<"===u||"{"===u)break;i+=u}return s({index:r.parseIndex++,type:"m-text",content:i.replace(o,function(e){return c[e]})},r),e},v=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,h=function(e,t,n,r,i,u){for(var o,c="";e<n;e++){var a=t[e];if("}"===a){e+=1;break}c+=a}for(;null!==(o=v.exec(c));){var f=o[1];void 0!==f&&-1===u.indexOf(f)&&i.push(f)}return s({index:r.parseIndex++,type:"m-expression",content:c},r),e},i=function(e,n){return e.reduce(function(e,t){return e+n(t)},"")},r=function(e){switch(e.type){case"m-fragment":return i(e.children,r);case"m-expression":return"m["+e.index+"] = m.ct("+e.content+");";case"m-text":return"m["+e.index+'] = m.ct("'+e.content+'");';default:return i(e.children,r)+"m["+e.index+'] = m.ce("'+e.type+'");'}},u=function(e,t){var n="";switch(e.type){case"m-fragment":return i(e.children,function(e){return u(e,t)});default:var r="m["+e.index+"]";"m-text"!==e.type&&"m-expression"!==e.type&&(n+=i(e.children,function(e){return u(e,r)})),n+="m.ma("+r+", "+t+");"}return n},x=function(e){switch(e.type){case"m-expression":return"m.ut(m["+e.index+"], "+e.content+");";case"m-text":return"";default:return i(e.children,x)}},y=function(e){return t=function(e){for(var t=e.length,n=[],r=["NaN","false","in","null","true","typeof","undefined"],i={type:"m-fragment",children:[],dependencies:n},u=[i],o=u.parseIndex=0;o<t;){var c=e[o];o="<"===c?"!"===e[o+1]&&"-"===e[o+2]&&"-"===e[o+3]?a(o+4,e,t):"/"===e[o+1]?p(o+2,e,t,u):m(o+1,e,t,u):"{"===c?h(o+1,e,t,u,n,r):l(o,e,t,u)}return i}(e),n="var m = this.m; "+i(t.dependencies,function(e){return"var "+e+" = this.data."+e+";"}),new Function("return [function () {"+n+r(t)+"}, function (root) {var m = this.m;"+u(t,"root")+"}, function () {var m = this.m;"+n+x(t)+"}]")();var t,n},b={},g=function(e){return document.createElement(e)},k=function(e){return document.createTextNode(e)},w=function(e,t){t.appendChild(e)},I=function(e,t){e.textContent=t},z=function(t,n,r){return function(){var e;this.name=t,this.data=r(),this.create=n[0],this.mount=n[1],this.update=n[2],this.m=((e=[]).c=b,e.ce=g,e.ct=k,e.ma=w,e.ut=I,e)}};function t(e,t,n){if("string"==typeof e&&(e=document.querySelector(e)),"string"==typeof t&&(t=y(t)),void 0===n)n=function(){return{}};else if("object"==typeof n){var r=n;n=function(){return r}}var i=new(z("m-root",t,n));return i.create(),i.mount(e),i}return t.extend=function(e,t,n){"string"==typeof t&&(t=y(t)),void 0===n&&(n=function(){return{}}),b[e]=z(e,t,n)},t.compile=y,t.config=e,t});