/**
 * Moon v1.0.0-alpha
 * Copyright 2016-2018 Kabir Shah
 * Released under the MIT License
 * https://kbrsh.github.io/moon
 */
!function(e,t){"undefined"==typeof module?e.Moon=t():module.exports=t()}(this,function(){"use strict";var o=function(e,t,n){for(;e<n;){var i=t[e],r=t[e+1],u=t[e+2];if("<"===i&&"!"===r&&"-"===u&&"-"===t[e+3])e=o(e+4,t,n);else{if("-"===i&&"-"===r&&">"===u){e+=3;break}e+=1}}return e},u=/"[^"]*"|'[^']*'|\d+[a-zA-Z$_]\w*|\.[a-zA-Z$_]\w*|[a-zA-Z$_]\w*:|([a-zA-Z$_]\w*)/g,a=["NaN","event","false","in","m","null","this","true","typeof","undefined"],s=function(e,t){for(var n,i=!1;null!==(n=u.exec(e));){var r=n[1];void 0!==r&&-1===a.indexOf(r)&&"$"!==r[0]&&(i=!0,-1===t.indexOf(r)&&t.push(r))}return i},e={silent:!0},d=/\s+/,v=function(e,t){t[t.length-1].children.push(e)},h=function(e,t,n,i,r){for(;e<n;){var u=t[e];if("/"===u||">"===u)break;if(d.test(u))e+=1;else{for(var a="",o="",c=!1;e<n;){if("/"===(u=t[e])||">"===u||d.test(u)){o=a;break}if("="===u){e+=1;break}a+=u,e+=1}if(0===o.length){var f=void 0;for('"'===(u=t[e])||"'"===u?(f=u,e+=1):"{"===u?(f="}",c=!0,e+=1):f=d;e<n&&"/"!==(u=t[e])&&">"!==u;){if("object"==typeof f&&f.test(u)||u===f){e+=1;break}o+=u,e+=1}}r.push({key:a,value:o,expression:c,dynamic:c&&s(o,i)})}}return e},c=function(e,t,n,i,r){for(var u={index:i[0].nextIndex++,type:"",attributes:[],children:[]};e<n;){var a=t[e];if(">"===a){for(var o=u.attributes,c=0;c<o.length;){var f=o[c];"#"===f.key[0]?(u={index:i[0].nextIndex++,type:f.key,attributes:[{key:"",value:f.value,expression:f.expression,dynamic:f.dynamic}],children:[u]},v(u,i),o.splice(c,1)):c+=1}v(u,i),i.push(u),e+=1;break}if("/"===a&&">"===t[e+1]){v(u,i),e+=2;break}d.test(a)&&(e+=1)||"="===a?e=h(e,t,n,r,u.attributes):(u.type+=a,e+=1)}return e},f=function(e,t,n,i){for(;e<n;e++){var r=t[e];if(">"===r){e+=1;break}r}var u=i.pop();return u.type,e},l=/(?:(?:&(?:amp|gt|lt|nbsp|quot);)|"|\\|\n)/g,x={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'\\"',"\\":"\\\\",'"':'\\"',"\n":"\\n"},m=function(e,t,n,i){for(var r="";e<n;e++){var u=t[e];if("<"===u||"{"===u)break;r+=u}return d.test(r)||v({index:i[0].nextIndex++,type:"#text",attributes:[{key:"",value:r.replace(l,function(e){return x[e]}),expression:!1,dynamic:!1}],children:[]},i),e},p=function(e,t,n,i,r){for(var u="";e<n;e++){var a=t[e];if("}"===a){e+=1;break}u+=a}return v({index:i[0].nextIndex++,type:"#text",attributes:[{key:"",value:u,expression:!0,dynamic:s(u,r)}],children:[]},i),e},y=function(e,n){return e.reduce(function(e,t){return e+n(t)},"")},b=function(e){return"m["+e+"]"},k=function(e,t){return b(e)+"="+t},w=function(e){return e.expression?e.value:'"'+e.value+'"'},g=function(e,t){return"m.sa("+b(e)+',"'+t.key+'",'+w(t)+");"},q=function(e,t){return"m.ac("+b(e)+","+b(t)+");"},I=function(i,t,n,e){var r,u,a,o;switch(i.type){case"#if":var c=i.ifCreate=n.nextIndex++;return k(i.index,"m.cc();")+q(i.index,t.index)+k(c,"function(){"+y(i.children,function(e){return I(e,t,n,i.index)})+"};")+"if("+w(i.attributes[0])+"){"+b(c)+"();}";case"#else":var f=i.elseCreate=n.nextIndex++;return"else{"+b(f)+"();}"+k(f,"function(){"+y(i.children,function(e){return I(e,t,n,i.index-1)})+"};");case"#text":r=k(i.index,"m.ctn("+w(i.attributes[0])+");");break;default:r=k(i.index,'m.ce("'+i.type+'");')+y(i.attributes,function(e){return"@"===e.key[0]?(t=i.index,n=e,"m.ael("+b(t)+',"'+n.key.substring(1)+'",function($event){'+w(n)+"});"):g(i.index,e);var t,n})+y(i.children,function(e){return I(e,i,n)})}return r+(void 0===e?q(i.index,t.index):(u=i.index,a=e,o=t.index,"m.ib("+b(u)+","+b(a)+","+b(o)+");"))},C=function(t,e,n){switch(t.type){case"#text":var i=t.attributes[0];return i.dynamic?(r=t.index,u=i.value,"m.stc("+b(r)+","+u+");"):"";default:return y(t.attributes,function(e){return"@"!==e.key[0]&&e.dynamic?g(t.index,e):""})+y(t.children,function(e){return C(e,t,n)})}var r,u},i=function(e,t,n){return i=e.index,r=t.index,"m.rc("+b(i)+","+b(r)+");";var i,r},$=function(e){return t=function(e){for(var t=e.length,n=[],i={index:0,nextIndex:1,type:"#root",attributes:[],children:[],dependencies:n},r=[i],u=0;u<t;){var a=e[u];u="<"===a?"!"===e[u+1]&&"-"===e[u+2]&&"-"===e[u+3]?o(u+4,e,t):"/"===e[u+1]?f(u+2,e,t,r):c(u+1,e,t,r,n):"{"===a?p(u+1,e,t,r,n):m(u,e,t,r)}return i}(e),n=y(t.dependencies,function(e){return"var "+e+"=this.data."+e+";"}),new Function("return [function(m){this.m[0]=m;m=this.m;"+n+y(t.children,function(e){return I(e,t,t)})+"},function(){var m=this.m;"+n+y(t.children,function(e){return C(e,t,t)})+"},function(){var m=this.m;"+y(t.children,function(e){return i(e,t)})+"m=[m[0]];}];")();var t,n},A={},z=function(e){return document.createElement(e)},Z=function(e){return document.createTextNode(e)},_=function(){return document.createComment("")},j=function(e,t,n){e.setAttribute(t,n)},N=function(e,t,n){e.addEventListener(t,n)},O=function(e,t){e.textContent=t},E=function(e,t){t.appendChild(e)},T=function(e,t){t.removeChild(e)},B=function(e,t,n){n.insertBefore(e,t)},F=function(e){this.view[0](e),this.emit("created")},L=function(){if(!1===this.queued){this.queued=!0;var e=this;setTimeout(function(){e.view[1](),e.queued=!1,e.emit("updated")},0)}},M=function(){this.view[2](),this.emit("destroyed")},S=function(e,t){if("object"==typeof e)for(var n in e)this.set(n,e[n]);else this.data[e]=t,this.update()},D=function(e,t){var n=this.data,i=n[e];void 0===i?n[e]=t:"function"==typeof i?n[e]=[i,t]:i.push(t)},G=function(e,t){if(void 0===t)this.data[e]=[];else{var n=this.data,i=n[e];"function"==typeof i?n[e]=void 0:i.splice(i.indexOf(t),1)}},H=function(e,t){var n=this.data[e];if(void 0!==n)if("function"==typeof n)n(t);else for(var i=0;i<n.length;i++)n[i](t)},J=function(u,a){return function(){var e,t=this;this.name=u,this.view=a.view.map(function(e){return e.bind(t)}),this.m=((e=[]).c=A,e.ce=z,e.ctn=Z,e.cc=_,e.sa=j,e.ael=N,e.stc=O,e.ac=E,e.rc=T,e.ib=B,e);var n=this.data=a.data(),i=a.actions;for(var r in i)n[r]=i[r].bind(t);this.queued=!1,this.create=F,this.update=L,this.destroy=M,this.set=S,this.on=D,this.off=G,this.emit=H}};function t(e){var t=e.root;"string"==typeof t&&(t=document.querySelector(t));var n=e.view;"string"==typeof n&&(e.view=$(n));var i=e.data;void 0===i?e.data=function(){return{}}:"object"==typeof i&&(e.data=function(){return i}),void 0===e.actions&&(e.actions={});var r=new(J("#m",e));return r.create(t),r}return t.extend=function(e,t){var n=t.view;"string"==typeof n&&(t.view=$(n)),void 0===t.data&&(t.data=function(){return{}}),void 0===t.actions&&(t.actions={}),A[e]=J(e,t)},t.compile=$,t.config=e,t});